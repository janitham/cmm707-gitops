apiVersion: batch/v1
kind: CronJob
metadata:
  name: integrationtest
  namespace: {{ include "registration.namespace" . }}
spec:
  schedule: "* * * * *"
  jobTemplate:
    spec:
      template:
        spec:
          containers:
            - name: testcontainer
              image: broadinstitute/python-requests
              imagePullPolicy: IfNotPresent
              #command: [ "/bin/sh", "-c", "cat /registration/registration-test-suite.py" ]
              command:
                - python
                - "/registration/registration-test-suite.py"
              volumeMounts:
                - name: "test"
                  mountPath: "/registration"
                  subPath: "registration-test-suite.py"
                - name: "test"
                  mountPath: "/summary-test-suite.py"
                  #subPath: "summary-test-suite.py"
          restartPolicy: OnFailure
          volumes:
            - name: "test"
              configMap:
                name: "testsuites"
                defaultMode: 0744